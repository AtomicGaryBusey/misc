# Overview

These are runtime maps for KAPE module (*.mkape) and target (*.tkape) definition files, which I built to get a better understanding of the actual applications and scripts running in my automated forensics pipeline.
This is vital for correctly implementing AppLocker allow-listing, monitoring 4688 logs for abnormalities on my processing machines, and more.

They're arranged in a logical flow. Some modules and targets exclusively call child .mkape and .tkape files which themselves run the actual jobs.
I've found this also makes it easier to build custom flows for jobs like Triage Forensics as opposed to a full collection.



## KAPE Modules (Stock)

| Main Module            | Module Description                                                     | Processor                                     | Processor Description                                                                                                                                                                                                                                                                                                                                | Executable                                 | 
|------------------------|------------------------------------------------------------------------|-----------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------| 
| !ALL.mkape             | Run all modules                                                        | *.mkape                                       | Literall all processors                                                                                                                                                                                                                                                                                                                              | *.mkape                                    | 
|                        |                                                                        | AmcacheParser.mkape                           | extract program execution information                                                                                                                                                                                                                                                                                                                | AmcacheParser.exe                          | 
|                        |                                                                        | Apache_Access_Log.mkape                       | LogParser Apache Access Log                                                                                                                                                                                                                                                                                                                          | LogParser.exe                              | 
|                        |                                                                        | AppCompatCacheParser.mkape                    | extract AppCompatCache (shimcache) information                                                                                                                                                                                                                                                                                                       | AppCompatCacheParser.exe                   | 
|                        |                                                                        | ApplicationEvents.mkape                       | Parses Application event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                                 | evtwalk64.exe                              | 
|                        |                                                                        | ApplicationFullEventLogView.mkape             | Parses Application event log using Nirsoft FullEventLogView.exe                                                                                                                                                                                                                                                                                      | FullEventLogView.exe                       | 
|                        |                                                                        | ARPCache.mkape                                | ARPCache                                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\arp.exe             | 
|                        |                                                                        | autoruns.mkape                                | "Autoruns reports Explorer shell extensions, toolbars, browser helper objects, Winlogon notifications, auto-start services, and much more."                                                                                                                                                                                                          | autorunsc.exe via PowerShell               | 
|                        |                                                                        | bitlocker-key.mkape                           | Collect BitLocker recovery key for a volume                                                                                                                                                                                                                                                                                                          | C:\\Windows\\System32\\manage-bde.exe      | 
|                        |                                                                        | BrowsingHistoryView.mkape                     | Browsing History View - Nirsoft                                                                                                                                                                                                                                                                                                                      | browsinghistoryview.exe                    | 
|                        |                                                                        | CCM-RUA.mkape                                 | Extracts SCCM software metering RecentlyUsedApplication logs from OBJECTS.DATA files                                                                                                                                                                                                                                                                 | CCM_RUA_Finder.exe                         | 
|                        |                                                                        | DensityScout.mkape                            | DensityScout                                                                                                                                                                                                                                                                                                                                         | densityscout.exe                           | 
|                        |                                                                        | Detailed-Network-Share-Access.mkape           | LogParser Security event 5145                                                                                                                                                                                                                                                                                                                        | LogParser.exe                              | 
|                        |                                                                        | DNSCache.mkape                                | DNSCache                                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\ipconfig.exe        | 
|                        |                                                                        | DumpIt.mkape                                  | DumpIt Memory Acquisition                                                                                                                                                                                                                                                                                                                            | DumpIt.exe                                 | 
|                        |                                                                        | EvtxECmd.mkape                                | process event log files                                                                                                                                                                                                                                                                                                                              | EvtxECmd\\EvtxECmd.exe                     | 
|                        |                                                                        | exiftool.mkape                                | process files                                                                                                                                                                                                                                                                                                                                        | exiftool.exe                               | 
|                        |                                                                        | Get-DoSvcExternalIP.mkape                     | extracts public IP addresses from DoSvc EventTraceLogs                                                                                                                                                                                                                                                                                               | Get-DoSvcExternalIP.ps1                    | 
|                        |                                                                        | Get-InjectedThread.mkape                      | Get-InjectedThread                                                                                                                                                                                                                                                                                                                                   | Get-InjectedThread.ps1                     | 
|                        |                                                                        | Get-NetworkConnection.mkape                   | Get-NetworkConnection including timestamps                                                                                                                                                                                                                                                                                                           | Get-NetworkConnection.ps1                  | 
|                        |                                                                        | handle.mkape                                  | Handle is a utility that displays information about open handles for any process in the system.                                                                                                                                                                                                                                                      | handle.exe                                 | 
|                        |                                                                        | Hashes.mkape                                  | Retrieve NTLM-hashes of all the user accounts                                                                                                                                                                                                                                                                                                        | mimikatz.exe                               | 
|                        |                                                                        | Hindsight.mkape                               | Chrome browser parsing                                                                                                                                                                                                                                                                                                                               | hindsight.exe                              | 
|                        |                                                                        | IPConfig.mkape                                | IPConfig                                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\ipconfig.exe        | 
|                        |                                                                        | iTunesBackup.mkape                            | Parses iTunes Backups                                                                                                                                                                                                                                                                                                                                | iTunes_Backup_Analyzer.exe                 | 
|                        |                                                                        | JLECmd.mkape                                  | process jumplist files                                                                                                                                                                                                                                                                                                                               | JLECmd.exe                                 | 
|                        |                                                                        | LECmd.mkape                                   | process .lnk files                                                                                                                                                                                                                                                                                                                                   | LECmd.exe                                  | 
|                        |                                                                        | Logon-Logoff-events.mkape                     | "LogParser Security events 4624,4625,4634,4647,4648,4772,4778,4779,4800,4801,4802,4803"                                                                                                                                                                                                                                                              | LogParser.exe                              | 
|                        |                                                                        | manage-bde.mkape                              | Check for BitLocker volumes                                                                                                                                                                                                                                                                                                                          | C:\\Windows\\System32\\manage-bde.exe      | 
| MFTECmd.mkape          | process all files handled by MFTECmd                                   | MFTECmd_$Boot.mkape                           | process $Boot files                                                                                                                                                                                                                                                                                                                                  | MFTECmd.exe                                | 
| MFTECmd.mkape          | process all files handled by MFTECmd                                   | MFTECmd_$MFT.mkape                            | process $MFT files                                                                                                                                                                                                                                                                                                                                   | MFTECmd.exe                                | 
| MFTECmd.mkape          | process all files handled by MFTECmd                                   | MFTECmd_$J.mkape                              | process $J files                                                                                                                                                                                                                                                                                                                                     | MFTECmd.exe                                | 
| MFTECmd.mkape          | process all files handled by MFTECmd                                   | MFTECmd_$SDS.mkape                            | process $SDS files                                                                                                                                                                                                                                                                                                                                   | MFTECmd.exe                                | 
|                        |                                                                        | NBTStat_NetBIOS_Cache.mkape                   | NBTStat_NETBIOS_Cache                                                                                                                                                                                                                                                                                                                                | c:\\windows\\system32\\nbtstat.exe         | 
|                        |                                                                        | NBTStat_NetBIOS_Sessions.mkape                | NBTStat_NETBIOS_Sessions                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\nbtstat.exe         | 
|                        |                                                                        | NetStat.mkape                                 | NetStat                                                                                                                                                                                                                                                                                                                                              | c:\\windows\\system32\\netstat.exe         | 
| NetworkDetails.mkape   | Network Details                                                        | IPConfig.mkape                                | IPConfig                                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\ipconfig.exe        | 
| NetworkDetails.mkape   | Network Details                                                        | DNSCache.mkape                                | DNSCache                                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\ipconfig.exe        | 
| NetworkDetails.mkape   | Network Details                                                        | ARPCache.mkape                                | ARPCache                                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\arp.exe             | 
| NetworkDetails.mkape   | Network Details                                                        | RoutingTable.mkape                            | RoutingTable                                                                                                                                                                                                                                                                                                                                         | c:\\windows\\system32\\route.exe           | 
| NetworkDetails.mkape   | Network Details                                                        | Netstat.mkape                                 | NetStat                                                                                                                                                                                                                                                                                                                                              | c:\\windows\\system32\\netstat.exe         | 
| NetworkDetails.mkape   | Network Details                                                        | NBTStat_Netbios_Sessions.mkape                | NBTStat_NETBIOS_Sessions                                                                                                                                                                                                                                                                                                                             | c:\\windows\\system32\\nbtstat.exe         | 
| NetworkDetails.mkape   | Network Details                                                        | NBTStat_Netbios_Cache.mkape                   | NBTStat_NETBIOS_Cache                                                                                                                                                                                                                                                                                                                                | c:\\windows\\system32\\nbtstat.exe         | 
|                        |                                                                        | PECmd.mkape                                   | process prefetch files                                                                                                                                                                                                                                                                                                                               | PECmd.exe                                  | 
|                        |                                                                        | Plaso.mkape                                   | plaso end to end test                                                                                                                                                                                                                                                                                                                                | psteal.exe                                 | 
|                        |                                                                        | PowerShell.mkape                              | Parses PowerShell-Operational event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                      | evtwalk64.exe                              | 
|                        |                                                                        | PowershellOperationalFullEventLogView.mkape   | Parses PowerShell-Operational event log using Nirsoft FullEventLogView.exe                                                                                                                                                                                                                                                                           | FullEventLogView.exe                       | 
|                        |                                                                        | PrintServiceOperationalFullEventLogView.mkape | Parses Microsoft-Windows-PrintService%4Operational event log using Nirsoft FullEventLogView.exe                                                                                                                                                                                                                                                      | FullEventLogView.exe                       | 
| ProcessDetails.mkape   | Combination Module for LiveResponse. Gathering Running Process Details | PWSH-Get-ProcessList.mkape                    | Display a running process list with a variety of fields                                                                                                                                                                                                                                                                                              | PowerShell.exe                             | 
| ProcessDetails.mkape   | Combination Module for LiveResponse. Gathering Running Process Details | pslist.mkape                                  | Shows statistics for all running processes                                                                                                                                                                                                                                                                                                           | pslist.exe                                 | 
| ProcessDetails.mkape   | Combination Module for LiveResponse. Gathering Running Process Details | pstree.mkape                                  | Shows a basic process tree for all running processes                                                                                                                                                                                                                                                                                                 | pslist.exe                                 | 
| ProcessDetails.mkape   | Combination Module for LiveResponse. Gathering Running Process Details | psservice.mkape                               | Display the configured services (both running and stopped) on the local system.                                                                                                                                                                                                                                                                      | PsService.exe                              | 
| ProcessDetails.mkape   | Combination Module for LiveResponse. Gathering Running Process Details | handle.mkape                                  | Handle is a utility that displays information about open handles for any process in the system.                                                                                                                                                                                                                                                      | handle.exe                                 | 
| ProcessDetails.mkape   | Combination Module for LiveResponse. Gathering Running Process Details | Get-InjectedThread.mkape                      | Get-InjectedThread                                                                                                                                                                                                                                                                                                                                   | Get-InjectedThread.ps1                     | 
|                        |                                                                        | psfile.mkape                                  | "PsFile is a command-line utility that shows a list of files on a system that are opened remotely, and it also allows you to close opened files either by name or by a file identifier."                                                                                                                                                             | psfile.exe                                 | 
|                        |                                                                        | psinfo.mkape                                  | "PsInfo is a command-line tool that gathers key information about the local or remote Windows NT/2000 system, including the type of installation, kernel build, registered organization and owner, number of processors and their type, amount of physical memory, the install date of the system, and if its a trial version, the expiration date." | PsInfo.exe                                 | 
|                        |                                                                        | pslist.mkape                                  | Shows statistics for all running processes                                                                                                                                                                                                                                                                                                           | pslist.exe                                 | 
|                        |                                                                        | psloggedon.mkape                              | "PsLoggedOn is an applet that displays both the locally logged on users and users logged on via resources for either the local computer, or a remote one."                                                                                                                                                                                           | PsLoggedon.exe                             | 
|                        |                                                                        | psservice.mkape                               | Display the configured services (both running and stopped) on the local system.                                                                                                                                                                                                                                                                      | PsService.exe                              | 
|                        |                                                                        | pstree.mkape                                  | Shows a basic process tree for all running processes                                                                                                                                                                                                                                                                                                 | pslist.exe                                 | 
|                        |                                                                        | PWSH-Get-ProcessList.mkape                    | Display a running process list with a variety of fields                                                                                                                                                                                                                                                                                              | PowerShell.exe                             | 
|                        |                                                                        | RBCmd.mkape                                   | process recycle bin artifacts                                                                                                                                                                                                                                                                                                                        | RBCmd.exe                                  | 
|                        |                                                                        | RDP-Usage-events.mkape                        | "LogParser RDP Usage Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational 21,22,23,24,25,39,40 and Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational 1149"                                                                                                                                                      | LogParser.exe                              | 
|                        |                                                                        | RDPCoreTS.mkape                               | Parses RemoteDesktopServices-RdpCoreTS event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                             | evtwalk64.exe                              | 
|                        |                                                                        | RecentFileCacheParser.mkape                   | extract file names from RecentFilecache.bcf                                                                                                                                                                                                                                                                                                          | RecentFileCacheParser.exe                  | 
|                        |                                                                        | RECmd.mkape                                   | Registry Hives Reports                                                                                                                                                                                                                                                                                                                               | RECmd.exe                                  | 
|                        |                                                                        | Registry_System.mkape                         | CAFAE: extract registry information                                                                                                                                                                                                                                                                                                                  | cafae64.exe                                | 
| RegRipper-ALL.mkape    | parse all supported hives                                              | RegRipper-ntuser.mkape                        | parse NTUSER hives                                                                                                                                                                                                                                                                                                                                   | rip.exe                                    | 
| RegRipper-ALL.mkape    | parse all supported hives                                              | RegRipper-sam.mkape                           | parse SAM hive                                                                                                                                                                                                                                                                                                                                       | rip.exe                                    | 
| RegRipper-ALL.mkape    | parse all supported hives                                              | RegRipper-security.mkape                      | parse SECURITY hive                                                                                                                                                                                                                                                                                                                                  | rip.exe                                    | 
| RegRipper-ALL.mkape    | parse all supported hives                                              | RegRipper-software.mkape                      | parse SOFTWARE hive                                                                                                                                                                                                                                                                                                                                  | rip.exe                                    | 
| RegRipper-ALL.mkape    | parse all supported hives                                              | RegRipper-system.mkape                        | parse SYSTEM hive                                                                                                                                                                                                                                                                                                                                    | rip.exe                                    | 
|                        |                                                                        | RoutingTable.mkape                            | RoutingTable                                                                                                                                                                                                                                                                                                                                         | c:\\windows\\system32\\route.exe           | 
|                        |                                                                        | SBECmd.mkape                                  | process shellbags                                                                                                                                                                                                                                                                                                                                    | SBECmd.exe                                 | 
|                        |                                                                        | ScheduledTasksFullEventLogView.mkape          | Parses TaskScheduler event log using Nirsoft FullEventLogView.exe                                                                                                                                                                                                                                                                                    | FullEventLogView.exe                       | 
|                        |                                                                        | SecurityEvents.mkape                          | Parses Security event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                                    | evtwalk64.exe                              | 
|                        |                                                                        | SecurityFullEventLogView.mkape                | Parses Security event log using Nirsoft FullEventLogView.exe                                                                                                                                                                                                                                                                                         | FullEventLogView.exe                       | 
|                        |                                                                        | SEPM_Logs.mkape                               | Symantec Logs                                                                                                                                                                                                                                                                                                                                        | SEPparser.exe                              | 
|                        |                                                                        | SigCheck.mkape                                | "Sigcheck all files in a volume, with hashes, entropy, and internal metadata"                                                                                                                                                                                                                                                                        | sigcheck64.exe                             | 
|                        |                                                                        | SMB-Server-Anonymous-Logon.mkape              | LogParser Microsoft-Windows-SMBServer-Security event 551                                                                                                                                                                                                                                                                                             | LogParser.exe                              | 
|                        |                                                                        | SparkCore.mkape                               | "SPARK Core, an IOC and YARA scanner written in Golang"                                                                                                                                                                                                                                                                                              | spark-core-win-x64.exe                     | 
|                        |                                                                        | srum-dump.mkape                               | Dump contents of the srum database                                                                                                                                                                                                                                                                                                                   | srum_dump_csv.exe                          | 
|                        |                                                                        | Symantec_Control_Log.mkape                    | LogParser Symantec Control Log                                                                                                                                                                                                                                                                                                                       | LogParser.exe                              | 
|                        |                                                                        | Symantec_Daily_AV.mkape                       | LogParser Symantec Daily AV Logs                                                                                                                                                                                                                                                                                                                     | LogParser.exe                              | 
|                        |                                                                        | Symantec_Security_Log.mkape                   | Symantec Security Log                                                                                                                                                                                                                                                                                                                                | SEPseclogParser.exe                        | 
|                        |                                                                        | Symantec_System_Log.mkape                     | Symantec System Log                                                                                                                                                                                                                                                                                                                                  | LogParser.exe                              | 
|                        |                                                                        | Symantec_Tamper_Protection_Log.mkape          | Symantec Tamper Protection Log                                                                                                                                                                                                                                                                                                                       | LogParser.exe                              | 
|                        |                                                                        | SystemEvents.mkape                            | Parses System event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                                      | evtwalk64.exe                              | 
|                        |                                                                        | SystemFullEventLogView.mkape                  | Parses System event log using Nirsoft FullEventLogView.exe                                                                                                                                                                                                                                                                                           | FullEventLogView.exe                       | 
|                        |                                                                        | TaskScheduler.mkape                           | Parses TaskScheduler-Operational event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                   | evtwalk64.exe                              | 
|                        |                                                                        | tcpvcon.mkape                                 | TCPView provides a more informative and conveniently presented subset of the Netstat program that ships with Windows.                                                                                                                                                                                                                                | Tcpvcon.exe                                | 
|                        |                                                                        | TeraCopy-history.mkape                        | Parses the history file databases for TeraCopy history                                                                                                                                                                                                                                                                                               | sqlite3.exe                                | 
|                        |                                                                        | TeraCopy-main.mkape                           | Parses the main.db for TeraCopy history                                                                                                                                                                                                                                                                                                              | sqlite3.exe                                | 
|                        |                                                                        | TS-LSM.mkape                                  | Parses TerminalServices-LocalSessionManager event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                        | evtwalk64.exe                              | 
|                        |                                                                        | TS-RCM.mkape                                  | Parses TerminalServices-RemoteConnectionManager event log using TZWorks\\nevtwalk64                                                                                                                                                                                                                                                                  | evtwalk64.exe                              | 
|                        |                                                                        | usbdeviceforensics.mkape                      | Parses USB Devices                                                                                                                                                                                                                                                                                                                                   | usbdeviceforensics\\usbdeviceforensics.exe | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | SecurityEvents.mkape                          | Parses Security event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                                    | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | SystemEvents.mkape                            | Parses System event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                                      | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | ApplicationEvents.mkape                       | Parses Application event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                                 | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | PowerShell.mkape                              | Parses PowerShell-Operational event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                      | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | RDPCoreTS.mkape                               | Parses RemoteDesktopServices-RdpCoreTS event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                             | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | TaskScheduler.mkape                           | Parses TaskScheduler-Operational event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                                   | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | TS-LSM.mkape                                  | Parses TerminalServices-LocalSessionManager event log using TZWorks evtwalk64                                                                                                                                                                                                                                                                        | evtwalk64.exe                              | 
| WindowsEventLogs.mkape | "Parses Windows Event Logs - Security, System, Application, etc."      | TS-RCM.mkape                                  | Parses TerminalServices-RemoteConnectionManager event log using TZWorks\\nevtwalk64                                                                                                                                                                                                                                                                  | evtwalk64.exe                              | 
|                        |                                                                        | WinPmem.mkape                                 | WinPmem Memory Dump                                                                                                                                                                                                                                                                                                                                  | winpmem.exe                                | 
|                        |                                                                        | WxTCmd.mkape                                  | process Windows Timeline/Activities Cache files                                                                                                                                                                                                                                                                                                      | WxTCmd.exe                                 | 
